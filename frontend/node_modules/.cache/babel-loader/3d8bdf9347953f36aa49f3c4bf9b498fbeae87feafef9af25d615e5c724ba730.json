{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\james\\\\lastest_app\\\\SC2006_SmartCommute\\\\frontend\\\\src\\\\pages\\\\SearchPage.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect, useContext } from 'react';\nimport Alert from '../components/Alert';\nimport { UserContext } from '../context/UserContext';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { GoogleMap, useJsApiLoader, StandaloneSearchBox, Marker } from \"@react-google-maps/api\";\nimport axios from 'axios';\nimport moment from 'moment-timezone';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_KEY = process.env.REACT_APP_GMAPSAPI;\nconst libraries = ['places'];\nconst SearchPage = () => {\n  _s();\n  const {\n    user: username\n  } = useContext(UserContext);\n  const [map, setMap] = useState(null);\n  const [markers, setMarkers] = useState([]);\n  const [center, setCenter] = useState({\n    lat: 1.3521,\n    lng: 103.8198\n  });\n  const [startLocation, setStartLocation] = useState('');\n  const [destination, setDestination] = useState('');\n  const [alert, setAlert] = useState({\n    show: false,\n    message: '',\n    type: ''\n  });\n  const [userLocation, setUserLocation] = useState(null);\n  const [favorites, setFavorites] = useState([]);\n  const [showFavoritesDropdown, setShowFavoritesDropdown] = useState({\n    start: false,\n    destination: false\n  });\n  const [line, setLine] = useState(null);\n  const [startLocationMarkerPosition, setStartLocationMarkerPosition] = useState(null);\n  const [destinationMarkerPosition, setDestinationMarkerPosition] = useState(null);\n  const startRef = useRef(null);\n  const destinationRef = useRef(null);\n  const navigate = useNavigate();\n  const location = useLocation();\n  const {\n    isLoaded\n  } = useJsApiLoader({\n    id: \"google-map-script\",\n    googleMapsApiKey: API_KEY,\n    libraries: libraries\n  });\n  const fetchFavorites = async () => {\n    try {\n      const response = await axios.get(`http://localhost:4000/favorites/${username}`);\n      setFavorites(response.data);\n    } catch (error) {\n      console.error(\"Error fetching favorites:\", error);\n      setAlert({\n        show: true,\n        message: \"Failed to load favorites.\",\n        type: \"error\"\n      });\n    }\n  };\n  useEffect(() => {\n    if (username) {\n      fetchFavorites();\n    }\n  }, [username]);\n  useEffect(() => {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(position => {\n        const userLatLng = {\n          lat: position.coords.latitude,\n          lng: position.coords.longitude\n        };\n        setUserLocation(userLatLng);\n      }, error => {\n        console.error('Error getting user location:', error);\n      });\n    }\n  }, []);\n  const drawLineBetweenMarkers = (start, destination) => {\n    if (line) {\n      line.setMap(null);\n      setLine(null);\n    }\n    const path = [new window.google.maps.LatLng(start.lat, start.lng), new window.google.maps.LatLng(destination.lat, destination.lng)];\n    const newLine = new window.google.maps.Polyline({\n      path: path,\n      geodesic: true,\n      strokeColor: '#FF0000',\n      strokeOpacity: 1.0,\n      strokeWeight: 2\n    });\n    newLine.setMap(map);\n    setLine(newLine);\n    const bounds = new window.google.maps.LatLngBounds();\n    bounds.extend(new window.google.maps.LatLng(start.lat, start.lng));\n    bounds.extend(new window.google.maps.LatLng(destination.lat, destination.lng));\n    map.fitBounds(bounds);\n  };\n  const handleSearch = async () => {\n    if (!startLocation || !destination) {\n      window.alert(\"Both Start Location and Destination fields must be filled!\");\n      return;\n    }\n    const sgTime = moment().tz('Asia/Singapore').format('YYYY-MM-DD HH:mm:ss');\n    try {\n      const response = await axios.post('http://localhost:4000/search/', {\n        username,\n        start_location: startLocation,\n        destination: destination,\n        timestamp: sgTime\n      });\n      if (response.status === 201) {\n        setAlert({\n          show: true,\n          message: \"Search saved to the database successfully!\",\n          type: \"success\"\n        });\n      }\n      navigate('/comparisons');\n    } catch (error) {\n      const errorMessage = error.response && error.response.data.error ? error.response.data.error : \"Failed to save to database!\";\n      setAlert({\n        show: true,\n        message: errorMessage,\n        type: \"error\"\n      });\n    }\n  };\n  const handleClear = field => {\n    if (field === 'start') {\n      setStartLocation('');\n      setStartLocationMarkerPosition(null);\n      setMarkers(prevMarkers => prevMarkers.filter(marker => marker.title !== 'Starting Location'));\n    } else if (field === 'destination') {\n      setDestination('');\n      setDestinationMarkerPosition(null);\n      setMarkers(prevMarkers => prevMarkers.filter(marker => marker.title !== 'Destination'));\n    }\n    if (line) {\n      line.setMap(null);\n      setLine(null);\n    }\n  };\n  const handleOnPlacesChanged = (inputType, ref) => {\n    const places = ref.getPlaces();\n    if (places && places.length > 0) {\n      const place = places[0];\n      if (place.geometry && place.geometry.location) {\n        const location = place.geometry.location;\n        const newMarker = {\n          position: {\n            lat: location.lat(),\n            lng: location.lng()\n          },\n          title: inputType === 'start' ? 'Starting Location' : 'Destination'\n        };\n        if (inputType === 'start') {\n          setStartLocation(place.formatted_address);\n          setStartLocationMarkerPosition(newMarker.position);\n          setMarkers(prevMarkers => prevMarkers.filter(marker => marker.title !== 'Starting Location').concat(newMarker));\n          if (map) {\n            map.setZoom(15);\n            map.panTo(newMarker.position);\n          }\n          if (line) line.setMap(null);\n        } else {\n          setDestination(place.formatted_address);\n          setDestinationMarkerPosition(newMarker.position);\n          setMarkers(prevMarkers => prevMarkers.filter(marker => marker.title !== 'Destination').concat(newMarker));\n        }\n        if (map) {\n          if (inputType === 'start' && destinationMarkerPosition) {\n            drawLineBetweenMarkers(newMarker.position, destinationMarkerPosition);\n          } else if (inputType === 'destination' && startLocationMarkerPosition) {\n            drawLineBetweenMarkers(startLocationMarkerPosition, newMarker.position);\n          }\n        }\n      }\n    }\n  };\n  const handleUseCurrentLocation = async () => {\n    if (userLocation) {\n      try {\n        const response = await axios.get(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${userLocation.lat},${userLocation.lng}&key=${API_KEY}`);\n        if (response.data && response.data.results.length > 0) {\n          const address = response.data.results[0].formatted_address;\n          setStartLocation(address);\n        } else {\n          setStartLocation('Unable to determine address');\n        }\n        setStartLocationMarkerPosition(userLocation);\n        setMarkers(prevMarkers => prevMarkers.filter(marker => marker.title !== 'Starting Location').concat({\n          position: userLocation,\n          title: 'Starting Location'\n        }));\n        if (destinationMarkerPosition) {\n          drawLineBetweenMarkers(userLocation, destinationMarkerPosition);\n        }\n      } catch (error) {\n        console.error('Error fetching address:', error);\n        setStartLocation('Unable to fetch address');\n      }\n    }\n  };\n  const handleFavoriteSelect = (favorite, inputType) => {\n    if (inputType === 'start') {\n      setStartLocation(favorite.location);\n    } else {\n      setDestination(favorite.location);\n    }\n    setShowFavoritesDropdown(prev => ({\n      ...prev,\n      [inputType]: false\n    }));\n    if (favorite.lat && favorite.lng) {\n      const position = {\n        lat: favorite.lat,\n        lng: favorite.lng\n      };\n      setMarkers(prevMarkers => prevMarkers.filter(marker => marker.title !== (inputType === 'start' ? 'Starting Location' : 'Destination')).concat({\n        position,\n        title: inputType === 'start' ? 'Starting Location' : 'Destination'\n      }));\n      if (map) {\n        map.panTo(position);\n      }\n    }\n  };\n  const handleFocus = inputType => {\n    if (inputType === 'start' && startLocation === '') {\n      setShowFavoritesDropdown(prev => ({\n        ...prev,\n        start: true\n      }));\n    } else if (inputType === 'destination' && destination === '') {\n      setShowFavoritesDropdown(prev => ({\n        ...prev,\n        destination: true\n      }));\n    }\n  };\n  const handleChange = (e, inputType) => {\n    if (inputType === 'start') {\n      setStartLocation(e.target.value);\n      setShowFavoritesDropdown(prev => ({\n        ...prev,\n        start: e.target.value === ''\n      }));\n    } else if (inputType === 'destination') {\n      setDestination(e.target.value);\n      setShowFavoritesDropdown(prev => ({\n        ...prev,\n        destination: e.target.value === ''\n      }));\n    }\n  };\n  const handleBlur = inputType => {\n    setTimeout(() => setShowFavoritesDropdown(prev => ({\n      ...prev,\n      [inputType]: false\n    })), 100);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex w-full h-[calc(100vh-8rem)] overflow-hidden pt-4\",\n    children: [alert.show && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute top-0 left-0 right-0 p-4 z-40\",\n      children: /*#__PURE__*/_jsxDEV(Alert, {\n        type: alert.type,\n        message: alert.message,\n        onClose: () => setAlert({\n          ...alert,\n          show: false\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-3/4 h-full\",\n      children: isLoaded ? /*#__PURE__*/_jsxDEV(GoogleMap, {\n        mapContainerStyle: {\n          width: '100%',\n          height: 'calc(100vh - 8rem)'\n        },\n        zoom: 12,\n        center: center,\n        onLoad: mapInstance => setMap(mapInstance),\n        children: markers.map((marker, index) => /*#__PURE__*/_jsxDEV(Marker, {\n          position: marker.position,\n          title: marker.title\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Loading....\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-1/4 h-full flex items-center justify-center p-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-3/4 max-w-md max-h-full overflow-visible flex flex-col justify-start relative\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleUseCurrentLocation,\n          className: \"mb-4 bg-green-300 p-2 rounded-md font-semibold hover:bg-[#4CAF50] transition shadow-lg\",\n          children: \"Use Current Location\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full mb-4 relative\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"startLocation\",\n            className: \"block text-gray-700 text-lg font-medium mb-2\",\n            children: \"Starting Location\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 13\n          }, this), isLoaded && /*#__PURE__*/_jsxDEV(StandaloneSearchBox, {\n            onLoad: ref => startRef.current = ref,\n            onPlacesChanged: () => handleOnPlacesChanged('start', startRef.current),\n            options: {\n              componentRestrictions: {\n                country: 'SG'\n              },\n              strictBounds: true\n            },\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              placeholder: \"Enter starting location\",\n              className: \"w-full p-3 border border-gray-300 rounded-lg shadow-sm\",\n              value: startLocation,\n              onChange: e => handleChange(e, 'start'),\n              onFocus: () => handleFocus('start'),\n              onBlur: () => handleBlur('start')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 291,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleClear('start'),\n            className: \"absolute right-3 top-1/2 transform bg-gray-300 text-sm text-gray-700 p-1 rounded-full hover:bg-gray-400\",\n            children: \"Clear\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 13\n          }, this), showFavoritesDropdown.start && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute top-full left-0 w-full bg-white border border-gray-300 rounded-lg shadow-lg mt-1 z-50\",\n            children: favorites.length > 0 ? favorites.map((favorite, index) => /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"w-full text-left px-4 py-2 hover:bg-gray-100\",\n              onClick: () => handleFavoriteSelect(favorite, 'start'),\n              children: favorite.name\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 312,\n              columnNumber: 21\n            }, this)) : /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-gray-500 p-2\",\n              children: \"No favorite locations available\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 321,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full mb-4 relative\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"destination\",\n            className: \"block text-gray-700 text-lg font-medium mb-2\",\n            children: \"Destination\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 328,\n            columnNumber: 13\n          }, this), isLoaded && /*#__PURE__*/_jsxDEV(StandaloneSearchBox, {\n            onLoad: ref => destinationRef.current = ref,\n            onPlacesChanged: () => handleOnPlacesChanged('destination', destinationRef.current),\n            options: {\n              componentRestrictions: {\n                country: 'SG'\n              },\n              strictBounds: true\n            },\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              placeholder: \"Enter destination\",\n              className: \"w-full p-3 border border-gray-300 rounded-lg shadow-sm\",\n              value: destination,\n              onChange: e => handleChange(e, 'destination'),\n              onFocus: () => handleFocus('destination'),\n              onBlur: () => handleBlur('destination')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 337,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 332,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleClear('destination'),\n            className: \"absolute right-3 top-1/2 transform bg-gray-300 text-sm text-gray-700 p-1 rounded-full hover:bg-gray-400\",\n            children: \"Clear\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 13\n          }, this), showFavoritesDropdown.destination && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute top-full left-0 w-full bg-white border border-gray-300 rounded-lg shadow-lg mt-1 z-50\",\n            children: favorites.length > 0 ? favorites.map((favorite, index) => /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"w-full text-left px-4 py-2 hover:bg-gray-100\",\n              onClick: () => handleFavoriteSelect(favorite, 'destination'),\n              children: favorite.name\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 358,\n              columnNumber: 21\n            }, this)) : /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-gray-500 p-2\",\n              children: \"No favorite locations available\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 367,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 355,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 327,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSearch,\n          className: \"w-full bg-blue-500 text-white p-3 rounded-lg font-medium hover:bg-blue-600 transition duration-200\",\n          children: \"Search\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 251,\n    columnNumber: 5\n  }, this);\n};\n_s(SearchPage, \"6DN75Kba49qwUIPA5jKqcmUaFbE=\", false, function () {\n  return [useNavigate, useLocation, useJsApiLoader];\n});\n_c = SearchPage;\nexport default SearchPage;\nvar _c;\n$RefreshReg$(_c, \"SearchPage\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useContext","Alert","UserContext","useNavigate","useLocation","GoogleMap","useJsApiLoader","StandaloneSearchBox","Marker","axios","moment","jsxDEV","_jsxDEV","API_KEY","process","env","REACT_APP_GMAPSAPI","libraries","SearchPage","_s","user","username","map","setMap","markers","setMarkers","center","setCenter","lat","lng","startLocation","setStartLocation","destination","setDestination","alert","setAlert","show","message","type","userLocation","setUserLocation","favorites","setFavorites","showFavoritesDropdown","setShowFavoritesDropdown","start","line","setLine","startLocationMarkerPosition","setStartLocationMarkerPosition","destinationMarkerPosition","setDestinationMarkerPosition","startRef","destinationRef","navigate","location","isLoaded","id","googleMapsApiKey","fetchFavorites","response","get","data","error","console","navigator","geolocation","getCurrentPosition","position","userLatLng","coords","latitude","longitude","drawLineBetweenMarkers","path","window","google","maps","LatLng","newLine","Polyline","geodesic","strokeColor","strokeOpacity","strokeWeight","bounds","LatLngBounds","extend","fitBounds","handleSearch","sgTime","tz","format","post","start_location","timestamp","status","errorMessage","handleClear","field","prevMarkers","filter","marker","title","handleOnPlacesChanged","inputType","ref","places","getPlaces","length","place","geometry","newMarker","formatted_address","concat","setZoom","panTo","handleUseCurrentLocation","results","address","handleFavoriteSelect","favorite","prev","handleFocus","handleChange","e","target","value","handleBlur","setTimeout","className","children","onClose","fileName","_jsxFileName","lineNumber","columnNumber","mapContainerStyle","width","height","zoom","onLoad","mapInstance","index","onClick","htmlFor","current","onPlacesChanged","options","componentRestrictions","country","strictBounds","placeholder","onChange","onFocus","onBlur","name","_c","$RefreshReg$"],"sources":["C:/Users/james/lastest_app/SC2006_SmartCommute/frontend/src/pages/SearchPage.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect, useContext } from 'react';\r\nimport Alert from '../components/Alert';\r\nimport { UserContext } from '../context/UserContext';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport { GoogleMap, useJsApiLoader, StandaloneSearchBox, Marker } from \"@react-google-maps/api\";\r\nimport axios from 'axios'; \r\nimport moment from 'moment-timezone';\r\n\r\nconst API_KEY = process.env.REACT_APP_GMAPSAPI;\r\nconst libraries = ['places'];\r\n\r\nconst SearchPage = () => {\r\n  const { user: username } = useContext(UserContext);\r\n  const [map, setMap] = useState(null);\r\n  const [markers, setMarkers] = useState([]);\r\n  const [center, setCenter] = useState({ lat: 1.3521, lng: 103.8198 });\r\n  const [startLocation, setStartLocation] = useState('');\r\n  const [destination, setDestination] = useState('');\r\n  const [alert, setAlert] = useState({ show: false, message: '', type: '' });\r\n  const [userLocation, setUserLocation] = useState(null);\r\n  const [favorites, setFavorites] = useState([]);\r\n  const [showFavoritesDropdown, setShowFavoritesDropdown] = useState({ start: false, destination: false });\r\n  \r\n  const [line, setLine] = useState(null); \r\n  const [startLocationMarkerPosition, setStartLocationMarkerPosition] = useState(null);\r\n  const [destinationMarkerPosition, setDestinationMarkerPosition] = useState(null);\r\n\r\n  const startRef = useRef(null);\r\n  const destinationRef = useRef(null);\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n\r\n  const { isLoaded } = useJsApiLoader({\r\n    id: \"google-map-script\",\r\n    googleMapsApiKey: API_KEY,\r\n    libraries: libraries,\r\n  });\r\n\r\n  const fetchFavorites = async () => {\r\n    try {\r\n      const response = await axios.get(`http://localhost:4000/favorites/${username}`);\r\n      setFavorites(response.data);\r\n    } catch (error) {\r\n      console.error(\"Error fetching favorites:\", error);\r\n      setAlert({ show: true, message: \"Failed to load favorites.\", type: \"error\" });\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (username) {\r\n      fetchFavorites();\r\n    }\r\n  }, [username]);\r\n\r\n  useEffect(() => {\r\n    if (navigator.geolocation) {\r\n      navigator.geolocation.getCurrentPosition(\r\n        (position) => {\r\n          const userLatLng = {\r\n            lat: position.coords.latitude,\r\n            lng: position.coords.longitude,\r\n          };\r\n          setUserLocation(userLatLng);\r\n        },\r\n        (error) => {\r\n          console.error('Error getting user location:', error);\r\n        }\r\n      );\r\n    }\r\n  }, []);\r\n\r\n  const drawLineBetweenMarkers = (start, destination) => {\r\n    if (line) {\r\n      line.setMap(null);\r\n      setLine(null);\r\n    }\r\n\r\n    const path = [\r\n      new window.google.maps.LatLng(start.lat, start.lng),\r\n      new window.google.maps.LatLng(destination.lat, destination.lng),\r\n    ];\r\n\r\n    const newLine = new window.google.maps.Polyline({\r\n      path: path,\r\n      geodesic: true,\r\n      strokeColor: '#FF0000',\r\n      strokeOpacity: 1.0,\r\n      strokeWeight: 2,\r\n    });\r\n\r\n    newLine.setMap(map);\r\n    setLine(newLine);\r\n\r\n    const bounds = new window.google.maps.LatLngBounds();\r\n    bounds.extend(new window.google.maps.LatLng(start.lat, start.lng));\r\n    bounds.extend(new window.google.maps.LatLng(destination.lat, destination.lng));\r\n    map.fitBounds(bounds);\r\n  };\r\n\r\n  const handleSearch = async () => { \r\n    if (!startLocation || !destination) {\r\n      window.alert(\"Both Start Location and Destination fields must be filled!\"); \r\n      return; \r\n    }\r\n\r\n    const sgTime = moment().tz('Asia/Singapore').format('YYYY-MM-DD HH:mm:ss');\r\n    try { \r\n      const response = await axios.post('http://localhost:4000/search/', {\r\n        username, start_location: startLocation, destination: destination, timestamp: sgTime, \r\n      }); \r\n      if (response.status === 201) { \r\n        setAlert({ show: true, message: \"Search saved to the database successfully!\", type: \"success\" });\r\n      }\r\n      navigate('/comparisons'); \r\n    } catch (error) { \r\n      const errorMessage = error.response && error.response.data.error ? error.response.data.error : \"Failed to save to database!\";\r\n      setAlert({ show: true, message: errorMessage, type: \"error\" }); \r\n    }\r\n  }\r\n\r\n  const handleClear = (field) => {\r\n    if (field === 'start') {\r\n      setStartLocation('');\r\n      setStartLocationMarkerPosition(null);\r\n      setMarkers((prevMarkers) => prevMarkers.filter(marker => marker.title !== 'Starting Location'));\r\n    } else if (field === 'destination') {\r\n      setDestination('');\r\n      setDestinationMarkerPosition(null);\r\n      setMarkers((prevMarkers) => prevMarkers.filter(marker => marker.title !== 'Destination'));\r\n    }\r\n\r\n    if (line) {\r\n      line.setMap(null);\r\n      setLine(null);\r\n    }\r\n  };\r\n\r\n  const handleOnPlacesChanged = (inputType, ref) => {\r\n    const places = ref.getPlaces();\r\n    if (places && places.length > 0) {\r\n      const place = places[0];\r\n      if (place.geometry && place.geometry.location) {\r\n        const location = place.geometry.location;\r\n\r\n        const newMarker = {\r\n          position: { lat: location.lat(), lng: location.lng() },\r\n          title: inputType === 'start' ? 'Starting Location' : 'Destination',\r\n        };\r\n\r\n        if (inputType === 'start') {\r\n          setStartLocation(place.formatted_address);\r\n          setStartLocationMarkerPosition(newMarker.position);\r\n\r\n          setMarkers((prevMarkers) => prevMarkers\r\n            .filter(marker => marker.title !== 'Starting Location')\r\n            .concat(newMarker));\r\n          \r\n          if (map) {\r\n            map.setZoom(15);\r\n            map.panTo(newMarker.position);\r\n          }\r\n\r\n          if (line) line.setMap(null);\r\n        } else {\r\n          setDestination(place.formatted_address);\r\n          setDestinationMarkerPosition(newMarker.position);\r\n\r\n          setMarkers((prevMarkers) => prevMarkers\r\n            .filter(marker => marker.title !== 'Destination')\r\n            .concat(newMarker));\r\n        }\r\n\r\n        if (map) {\r\n          if (inputType === 'start' && destinationMarkerPosition) {\r\n            drawLineBetweenMarkers(newMarker.position, destinationMarkerPosition);\r\n          } else if (inputType === 'destination' && startLocationMarkerPosition) {\r\n            drawLineBetweenMarkers(startLocationMarkerPosition, newMarker.position);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleUseCurrentLocation = async () => {\r\n    if (userLocation) {\r\n      try {\r\n        const response = await axios.get(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${userLocation.lat},${userLocation.lng}&key=${API_KEY}`);\r\n        \r\n        if (response.data && response.data.results.length > 0) {\r\n          const address = response.data.results[0].formatted_address;\r\n          setStartLocation(address);\r\n        } else {\r\n          setStartLocation('Unable to determine address');\r\n        }\r\n\r\n        setStartLocationMarkerPosition(userLocation);\r\n        setMarkers((prevMarkers) => prevMarkers.filter(marker => marker.title !== 'Starting Location')\r\n          .concat({ position: userLocation, title: 'Starting Location' }));\r\n\r\n        if (destinationMarkerPosition) {\r\n          drawLineBetweenMarkers(userLocation, destinationMarkerPosition);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching address:', error);\r\n        setStartLocation('Unable to fetch address');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleFavoriteSelect = (favorite, inputType) => {\r\n    if (inputType === 'start') {\r\n      setStartLocation(favorite.location); \r\n    } else {\r\n      setDestination(favorite.location);\r\n    }\r\n    setShowFavoritesDropdown((prev) => ({ ...prev, [inputType]: false }));\r\n    \r\n    if (favorite.lat && favorite.lng) {\r\n      const position = { lat: favorite.lat, lng: favorite.lng };\r\n      setMarkers((prevMarkers) => prevMarkers.filter(marker => marker.title !== (inputType === 'start' ? 'Starting Location' : 'Destination'))\r\n        .concat({ position, title: inputType === 'start' ? 'Starting Location' : 'Destination' }));\r\n      if (map) {\r\n        map.panTo(position);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleFocus = (inputType) => {\r\n    if (inputType === 'start' && startLocation === '') {\r\n      setShowFavoritesDropdown((prev) => ({ ...prev, start: true }));\r\n    } else if (inputType === 'destination' && destination === '') {\r\n      setShowFavoritesDropdown((prev) => ({ ...prev, destination: true }));\r\n    }\r\n  };\r\n\r\n  const handleChange = (e, inputType) => {\r\n    if (inputType === 'start') {\r\n      setStartLocation(e.target.value);\r\n      setShowFavoritesDropdown((prev) => ({ ...prev, start: e.target.value === '' }));\r\n    } else if (inputType === 'destination') {\r\n      setDestination(e.target.value);\r\n      setShowFavoritesDropdown((prev) => ({ ...prev, destination: e.target.value === '' }));\r\n    }\r\n  };\r\n\r\n  const handleBlur = (inputType) => {\r\n    setTimeout(() => setShowFavoritesDropdown((prev) => ({ ...prev, [inputType]: false })), 100);\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex w-full h-[calc(100vh-8rem)] overflow-hidden pt-4\">\r\n      {alert.show && (\r\n        <div className=\"absolute top-0 left-0 right-0 p-4 z-40\">\r\n          <Alert type={alert.type} message={alert.message} onClose={() => setAlert({ ...alert, show: false })} />\r\n        </div>\r\n      )}\r\n  \r\n      <div className=\"w-3/4 h-full\">\r\n        {isLoaded ? (\r\n          <GoogleMap\r\n            mapContainerStyle={{ width: '100%', height: 'calc(100vh - 8rem)' }}\r\n            zoom={12}\r\n            center={center}\r\n            onLoad={(mapInstance) => setMap(mapInstance)}\r\n          >\r\n            {markers.map((marker, index) => (\r\n              <Marker key={index} position={marker.position} title={marker.title} />\r\n            ))}\r\n          </GoogleMap>\r\n        ) : (\r\n          <div>Loading....</div>\r\n        )}\r\n      </div>\r\n  \r\n      <div className=\"w-1/4 h-full flex items-center justify-center p-4\">\r\n        <div className=\"w-3/4 max-w-md max-h-full overflow-visible flex flex-col justify-start relative\">\r\n          <button onClick={handleUseCurrentLocation} className=\"mb-4 bg-green-300 p-2 rounded-md font-semibold hover:bg-[#4CAF50] transition shadow-lg\">\r\n            Use Current Location\r\n          </button>\r\n  \r\n          <div className=\"w-full mb-4 relative\">\r\n            <label htmlFor=\"startLocation\" className=\"block text-gray-700 text-lg font-medium mb-2\">\r\n              Starting Location\r\n            </label>\r\n            {isLoaded && (\r\n              <StandaloneSearchBox\r\n                onLoad={(ref) => (startRef.current = ref)}\r\n                onPlacesChanged={() => handleOnPlacesChanged('start', startRef.current)}\r\n                options={{ componentRestrictions: { country: 'SG' }, strictBounds: true }}\r\n              >\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Enter starting location\"\r\n                  className=\"w-full p-3 border border-gray-300 rounded-lg shadow-sm\"\r\n                  value={startLocation}\r\n                  onChange={(e) => handleChange(e, 'start')}\r\n                  onFocus={() => handleFocus('start')}\r\n                  onBlur={() => handleBlur('start')}\r\n                />\r\n              </StandaloneSearchBox>\r\n            )}\r\n            <button \r\n              onClick={() => handleClear('start')} \r\n              className=\"absolute right-3 top-1/2 transform bg-gray-300 text-sm text-gray-700 p-1 rounded-full hover:bg-gray-400\"\r\n            >\r\n              Clear\r\n            </button>\r\n            {showFavoritesDropdown.start && (\r\n              <div className=\"absolute top-full left-0 w-full bg-white border border-gray-300 rounded-lg shadow-lg mt-1 z-50\">\r\n                {favorites.length > 0 ? (\r\n                  favorites.map((favorite, index) => (\r\n                    <button\r\n                      key={index}\r\n                      className=\"w-full text-left px-4 py-2 hover:bg-gray-100\"\r\n                      onClick={() => handleFavoriteSelect(favorite, 'start')}\r\n                    >\r\n                      {favorite.name}\r\n                    </button>\r\n                  ))\r\n                ) : (\r\n                  <p className=\"text-gray-500 p-2\">No favorite locations available</p>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n  \r\n          <div className=\"w-full mb-4 relative\">\r\n            <label htmlFor=\"destination\" className=\"block text-gray-700 text-lg font-medium mb-2\">\r\n              Destination\r\n            </label>\r\n            {isLoaded && (\r\n              <StandaloneSearchBox\r\n                onLoad={(ref) => (destinationRef.current = ref)}\r\n                onPlacesChanged={() => handleOnPlacesChanged('destination', destinationRef.current)}\r\n                options={{ componentRestrictions: { country: 'SG' }, strictBounds: true }}\r\n              >\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Enter destination\"\r\n                  className=\"w-full p-3 border border-gray-300 rounded-lg shadow-sm\"\r\n                  value={destination}\r\n                  onChange={(e) => handleChange(e, 'destination')}\r\n                  onFocus={() => handleFocus('destination')}\r\n                  onBlur={() => handleBlur('destination')}\r\n                />\r\n              </StandaloneSearchBox>\r\n            )}\r\n            <button \r\n              onClick={() => handleClear('destination')} \r\n              className=\"absolute right-3 top-1/2 transform bg-gray-300 text-sm text-gray-700 p-1 rounded-full hover:bg-gray-400\"\r\n            >\r\n              Clear\r\n            </button>\r\n            {showFavoritesDropdown.destination && (\r\n              <div className=\"absolute top-full left-0 w-full bg-white border border-gray-300 rounded-lg shadow-lg mt-1 z-50\">\r\n                {favorites.length > 0 ? (\r\n                  favorites.map((favorite, index) => (\r\n                    <button\r\n                      key={index}\r\n                      className=\"w-full text-left px-4 py-2 hover:bg-gray-100\"\r\n                      onClick={() => handleFavoriteSelect(favorite, 'destination')}\r\n                    >\r\n                      {favorite.name}\r\n                    </button>\r\n                  ))\r\n                ) : (\r\n                  <p className=\"text-gray-500 p-2\">No favorite locations available</p>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n  \r\n          <button onClick={handleSearch} className=\"w-full bg-blue-500 text-white p-3 rounded-lg font-medium hover:bg-blue-600 transition duration-200\">\r\n            Search\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  ); \r\n};\r\n\r\nexport default SearchPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}